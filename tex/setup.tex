% Set the page size.
\geometry{paper=letterpaper, margin=1in}

% Set up our preferred fonts.
\setmainfont[Ligatures={Common,TeX}]{Libertinus Serif}
\setmathfont{Libertinus Math}
\newfontfamily\FancyFont{Envision}

% Store a subtitle
\newcommand{\thesubtitle}{}
\newcommand{\subtitle}[1]{\renewcommand{\thesubtitle}{#1}}

% Don't indent paragraphs; separate them with whitespace.
\setlength{\parindent}{0pt}
\setlength{\parskip}{1em}

% Don't show numbers for titles, and set up formating.
\titleformat{\chapter}{\FancyFont\huge}{}{0pt}{}
\titleformat{\section}{\FancyFont\large}{}{0pt}{}
\titleformat{\subsection}{\normalfont\large\bfseries\scshape}{}{0pt}{}

% Reduce spacing around titles.
\titlespacing*{\section}{0pt}{0.5\parskip}{0pt}
\titlespacing*{\subsection}{0pt}{0.5\parskip}{0pt}

% URLs should be typeset in the same font as the surrouding text.
\urlstyle{same}

% Dates are separated with -, not /
\renewcommand{\dateseparator}{-}

% A date format for Day Month Year style dates.
\newdateformat{ddmmmyyyydate}{%
    \ifshowdow\dayofweekname{\THEDAY}{\THEMONTH}{\THEYEAR}\fi
    \THEDAY{} \monthname[\THEMONTH{}] \THEYEAR{}%
}

\newcommand{\mychapter}[2]{%
    \chapter{#2}\label{chapter:#2}%
}

\newcommand{\mysection}[2]{%
    \section{#2}\label{section:#1}%
}

\newcommand{\mysubsection}[2]{%
    \subsection{#2}\label{subsection:#1}%
}

\newcommand{\Dots}[1]{%
    \normalfont\multido{}{#1}{â€¢}%
}

\makeatletter
\define@key{MeritKeys}{Description}{\def\MeritDescription{#1}}
\define@key{MeritKeys}{Keywords}{\def\MeritKeywords{#1}}
\makeatother

\NewEnviron{Merit}[3]{%
    \def\MeritName{#1}%
    \def\MeritLabel{#3}%
    \setkeys{MeritKeys}{%
        Keywords=None,%
        #2}%
    \needspace{4\baselineskip}%
    \section{\MeritName}\label{merit:\MeritLabel}%
    \vspace{-0.75\parskip}%
    {\large\FancyFont(\MeritDescription)}\\[0.5\parskip]%
    %\vspace{-0.5\parskip}%
    \textbf{Keywords:} \MeritKeywords%
    \par\BODY%
}

\makeatletter
\define@key{CharmKeys}{Cost}{\def\CharmCost{#1}}
\define@key{CharmKeys}{Duration}{\def\CharmDuration{#1}}
\define@key{CharmKeys}{Keywords}{\def\CharmKeywords{#1}}
\define@key{CharmKeys}{Mins}{\def\CharmMins{#1}}
\define@key{CharmKeys}{Prerequisites}{\def\CharmPrerequisites{#1}}
\define@key{CharmKeys}{Type}{\def\CharmType{#1}}
\makeatother

\NewEnviron{Charm}[3]{%
    \def\CharmName{#1}%
    \def\CharmLabel{#3}%
    \setkeys{CharmKeys}{%
        Cost=--,%
        Keywords=None,%
        Mins=None,%
        Prerequisites=None,%
        #2}%
    \needspace{6.5\baselineskip}%
    \subsection{\CharmName}\label{charm:\CharmLabel}%
    \vspace{-0.5\parskip}%
    \textbf{Cost:} \CharmCost; \textbf{Mins:} \CharmMins\\%
    \textbf{Type:} \CharmType\\%
    \textbf{Keywords:} \CharmKeywords\\%
    \textbf{Duration:} \CharmDuration\\%
    \textbf{Prerequisites:} \CharmPrerequisites%
    \par\BODY%
}

% vim: filetype=tex: textwidth=79:

